<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Juego del Impostor</title>
  <style>
    :root{
      --bg:#0b0f14;
      --card:#121826;
      --muted:#8ea0b5;
      --text:#e7eef7;
      --line:#233044;
      --shadow: 0 10px 30px rgba(0,0,0,.35);
    }
    *{ box-sizing:border-box; }
    body{
      margin:0;
      font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
      background: radial-gradient(1200px 700px at 20% -10%, #17223a 0%, transparent 55%),
                  radial-gradient(1200px 700px at 120% 10%, #1e1533 0%, transparent 55%),
                  var(--bg);
      color:var(--text);
      min-height:100vh;
      display:flex;
      align-items:center;
      justify-content:center;
      padding:16px;
    }
    .app{
      width:min(980px, 100%);
      background: linear-gradient(180deg, rgba(255,255,255,.04), rgba(255,255,255,.02));
      border:1px solid var(--line);
      border-radius:18px;
      box-shadow:var(--shadow);
      overflow:hidden;
    }
    header{
      padding:18px 16px;
      border-bottom:1px solid var(--line);
      display:flex;
      gap:10px;
      flex-wrap:wrap;
      align-items:center;
      justify-content:space-between;
    }
    header h1{
      font-size:18px;
      margin:0;
      letter-spacing:.2px;
    }
    header p{
      margin:0;
      color:var(--muted);
      font-size:13px;
    }
    .content{
      padding:16px;
      display:grid;
      grid-template-columns: 1fr;
      gap:14px;
    }

    .panel{
      background: rgba(0,0,0,.18);
      border:1px solid var(--line);
      border-radius:14px;
      padding:14px;
    }

    .row{
      display:flex;
      gap:10px;
      flex-wrap:wrap;
      align-items:flex-end;
    }
    label{
      display:flex;
      flex-direction:column;
      gap:6px;
      font-size:12px;
      color:var(--muted);
    }
    input{
      width:140px;
      max-width:100%;
      padding:10px 10px;
      border-radius:10px;
      border:1px solid var(--line);
      background:#0f1522;
      color:var(--text);
      outline:none;
    }
    input:focus{
      border-color:#3b82f6;
      box-shadow: 0 0 0 3px rgba(59,130,246,.18);
    }

    .btns{
      display:flex;
      gap:10px;
      flex-wrap:wrap;
    }
    button{
      border:none;
      color:white;
      padding:10px 12px;
      border-radius:10px;
      cursor:pointer;
      font-weight:600;
      letter-spacing:.2px;
      transition: transform .05s ease, filter .15s ease;
    }
    button:active{ transform: translateY(1px); }
    button:disabled{
      opacity:.55;
      cursor:not-allowed;
      filter: grayscale(.3);
    }

    /* Tus clases */
    .startbtn{ background-color:green; }
    .revealBtn{ background-color:red; }
    .nextBtn{ background-color:blue; }
    .resetBtn{ background-color:grey; }

    .game{
      display:grid;
      grid-template-columns: 1.1fr .9fr;
      gap:14px;
    }
    @media (max-width: 860px){
      .game{ grid-template-columns:1fr; }
      input{ width:100%; }
    }

    .status{
      display:flex;
      flex-direction:column;
      gap:8px;
    }
    .pill{
      display:inline-flex;
      align-items:center;
      gap:8px;
      padding:8px 10px;
      border-radius:999px;
      border:1px solid var(--line);
      background: rgba(255,255,255,.04);
      width:fit-content;
      color:var(--muted);
      font-size:13px;
    }

    .card{
      background: rgba(255,255,255,.03);
      border:1px solid var(--line);
      border-radius:14px;
      padding:14px;
      display:flex;
      flex-direction:column;
      gap:12px;
      min-height:320px;
    }

    .topControls{
      display:flex;
      gap:10px;
      flex-wrap:wrap;
      align-items:center;
      justify-content:flex-start;
    }

    .who{
      font-size:13px;
      color:var(--muted);
    }
    .big{
      font-size:28px;
      margin:0;
      line-height:1.15;
      letter-spacing:.2px;
    }
    .hint{
      color:var(--muted);
      font-size:13px;
      margin:0;
    }

    .imgWrap{
      display:flex;
      gap:12px;
      align-items:flex-start;
      flex-wrap:wrap;
    }
    .charImg{
      width:min(360px, 100%);
      background:#0f1522;
      border:1px solid var(--line);
      border-radius:14px;
      overflow:hidden;
      position:relative;
      min-height:220px; /* para que el placeholder tenga espacio */
    }
    .charImg img{
      width:100%;
      height:auto;           /* ajuste a la relaci√≥n de aspecto real */
      object-fit:contain;    /* evita recortes */
      display:block;
    }
    .placeholder{
      position:absolute;
      inset:0;
      display:flex;
      align-items:center;
      justify-content:center;
      padding:14px;
      text-align:center;
      color:var(--muted);
      font-size:13px;
      line-height:1.35;
    }

    .rightPanel{
      display:flex;
      flex-direction:column;
      gap:12px;
    }
    .list{
      display:grid;
      grid-template-columns:1fr 1fr;
      gap:10px;
    }
    @media (max-width: 520px){
      .list{ grid-template-columns:1fr; }
      .big{ font-size:24px; }
    }

    .mini{
      border:1px solid var(--line);
      border-radius:12px;
      background: rgba(255,255,255,.03);
      padding:10px;
      color:var(--muted);
      font-size:13px;
    }
    .mini strong{ color:var(--text); }

    .note{
      color:var(--muted);
      font-size:12px;
      margin:0;
    }
  </style>
</head>
<body>
  <div class="app">
    <header>
      <div>
        <h1>Juego del Impostor</h1>
        <p>1 impostor (‚â§ 6 jugadores) ‚Ä¢ 2 impostores (> 6 jugadores)</p>
      </div>
      <div class="pill" id="phasePill">Fase: Configuraci√≥n</div>
    </header>

    <div class="content">
      <section class="panel">
        <div class="row">
          <label>
            Cantidad de jugadores
            <input id="playersInput" type="number" min="3" max="30" value="7" />
          </label>

          <div class="btns">
            <button id="startBtn" class="startbtn">Iniciar partida</button>
            <button id="resetBtn" class="resetBtn" disabled>Reiniciar</button>
          </div>
        </div>
        <p class="note">
          Tip: coloca tus im√°genes en <strong>charactersImages/</strong> con nombres tipo <strong>goku.jpg</strong>, <strong>spider-man.jpg</strong>, etc.
        </p>
      </section>

      <section class="game">
        <div class="card">
          <!-- Botones SIEMPRE arriba de la imagen -->
          <div class="topControls">
            <button id="revealBtn" class="revealBtn" disabled>Revelar</button>

            <!-- MISMO bot√≥n para Ocultar + Siguiente -->
            <button id="nextBtn" class="nextBtn" disabled>Ocultar / Siguiente</button>
          </div>

          <div class="status">
            <div class="who" id="whoText">A√∫n no inicia la partida.</div>
            <h2 class="big" id="roleText">‚Äî</h2>
            <p class="hint" id="hintText">Inicia la partida para asignar roles.</p>
          </div>

          <div class="imgWrap">
            <div class="charImg" aria-label="Imagen del personaje">
              <img id="characterImage" alt="Imagen del personaje" style="display:none;" />
              <div class="placeholder" id="imgPlaceholder">
                Aqu√≠ aparecer√° la imagen del personaje.
              </div>
            </div>
          </div>
        </div>

        <div class="rightPanel">
          <div class="panel">
            <div class="pill" id="progressPill">Jugadores: 0/0</div>
            <div class="list">
              <div class="mini"><strong>Impostores:</strong> <span id="impostorCount">‚Äî</span></div>
              <div class="mini"><strong>Modo:</strong> Oscuro</div>
            </div>
            <p class="note">
              El impostor <strong>no ve el nombre</strong> del personaje. Ve ‚ÄúIMPOSTOR‚Äù.
            </p>
          </div>
        </div>
      </section>
    </div>
  </div>

  <script>
    // ==========
    // LISTA DE PERSONAJES (tu lista)
    // ==========
    const CHARACTERS = [
      "Shrek","Fiona","Burro","Gato con Botas","Mickey Mouse",
      "Minnie Mouse","Pato Donald","Goofy","Simba","Scar",
      "Ariel","Elsa","Anna","Olaf","Aladd√≠n",
      "Genio","Woody","Buzz Lightyear","Homero Simpson","Bart Simpson",
      "Marge Simpson","Lisa Simpson","Bob Esponja","Patricio Estrella","Calamardo",
      "Batman","Superman","Mujer Maravilla","Guas√≥n","Spider-Man",
      "Iron Man","Capit√°n Am√©rica","Thor","Hulk","Thanos",
      "Darth Vader","Luke Skywalker","Yoda","Princesa Leia","Han Solo",
      "Gok√∫","Vegeta","Naruto Uzumaki","Sasuke Uchiha","Monkey D. Luffy",
      "Pikachu","Ash Ketchum","Mario","Luigi","Bowser",
      "Link","Zelda","Sonic",
      "Harry Potter","Hermione Granger","Ron Weasley","Voldemort","Hagrid",
      "James Bond","Rocky Balboa","Terminator",
      "John Wick","Neo","Jack Sparrow",
      "Davy Jones","Viuda Negra","Doctor Strange","Wolverine","Deadpool",
      "Profesor X","Magneto","Dobby","Gandalf","Frodo Bols√≥n",
      "Legolas","Gollum","Daenerys Targaryen",
      "Jon Snow","Tyrion Lannister","Cersei Lannister","Arya Stark","Walter White","Rick S√°nchez","Morty Smith","Scooby-Doo",
      "Shaggy","Pedro Picapiedra","Tom","Jerry",
      "Popeye","Bugs Bunny","Pato Lucas","Elmer Gru√±√≥n","Optimus Prime",,"Bumblebee","Godzilla","King Kong","Jason Voorhees",
      "Freddy Krueger","Michael Myers","Chucky","Pennywise","Dora la Exploradora"
      ,"Peppa Pig","Hello Kitty","Barbie","Ken",
      "He-Man","Skeletor","Power Ranger Rojo",
      "Lara Croft","Joel Miller","Sephiroth","Pac-Man","Mega Man","Sub-Zero","Scorpion","Aang",
      "Zuko","Korra","Po","Tai Lung","Wall-E","EVA","Rayo McQueen","Mate","Remy","Gru","Minion","H√©rcules",
      "Peter Pan","Campanita","Capit√°n Garfio","Pinocho","Dumbo",
      "Bambi","Stitch","Mul√°n","Moana","Baymax","Ben 10","Finn el Humano","Jake el Perro",
      "Samurai Jack"
    ];

    // ==========
    // CONFIG IM√ÅGENES LOCALES
    // ==========
    const IMAGE_FOLDER = "charactersImages/";
    const DEFAULT_EXT = ".jpg"; // cambia a .png si tus im√°genes son PNG

    // Imagen del impostor (pon un archivo real en charactersImages/)
    // Por ejemplo: charactersImages/impostor.jpg
    const IMPOSTOR_IMAGE = IMAGE_FOLDER + "impostor" + DEFAULT_EXT;

    function slugify(name){
      // convierte "Frodo Bols√≥n" -> "frodo-bolson"
      return name
        .toLowerCase()
        .normalize("NFD").replace(/[\u0300-\u036f]/g, "") // quita acentos
        .replace(/['".,()]/g, "") // quita puntuaci√≥n com√∫n
        .replace(/[^a-z0-9]+/g, "-") // espacios y s√≠mbolos -> guiones
        .replace(/^-+|-+$/g, ""); // recorta guiones
    }

    function getCharacterImagePath(characterName){
      return IMAGE_FOLDER + slugify(characterName) + DEFAULT_EXT;
    }

    // ==========
    // ELEMENTOS UI
    // ==========
    const playersInput = document.getElementById("playersInput");

    const startBtn = document.getElementById("startBtn");
    const resetBtn = document.getElementById("resetBtn");

    const revealBtn = document.getElementById("revealBtn");
    const nextBtn = document.getElementById("nextBtn"); // ahora sirve para Ocultar + Siguiente

    const whoText = document.getElementById("whoText");
    const roleText = document.getElementById("roleText");
    const hintText = document.getElementById("hintText");

    const characterImage = document.getElementById("characterImage");
    const imgPlaceholder = document.getElementById("imgPlaceholder");

    const phasePill = document.getElementById("phasePill");
    const progressPill = document.getElementById("progressPill");
    const impostorCount = document.getElementById("impostorCount");

    // ==========
    // ESTADO
    // ==========
    let game = null;

    function setPhase(text){
      phasePill.textContent = "Fase: " + text;
    }
    function setProgress(current, total){
      progressPill.textContent = `Jugadores: ${current}/${total}`;
    }

    function showImage(src, altText){
      characterImage.style.display = "block";
      imgPlaceholder.style.display = "none";
      characterImage.alt = altText || "Imagen";

      characterImage.onerror = () => {
        characterImage.style.display = "none";
        imgPlaceholder.style.display = "flex";
        imgPlaceholder.textContent = `No se encontr√≥ la imagen.\n\nArchivo esperado:\n${src}`;
      };

      characterImage.src = src;
    }

    function hideImage(){
      characterImage.style.display = "none";
      characterImage.removeAttribute("src");
      imgPlaceholder.style.display = "flex";
      imgPlaceholder.textContent = "Aqu√≠ aparecer√° la imagen del personaje.";
    }

    function pickRandom(arr){
      return arr[Math.floor(Math.random() * arr.length)];
    }

    function buildRoles(playerCount){
      const impostors = (playerCount > 6) ? 2 : 1;
      const character = pickRandom(CHARACTERS);

      const roles = Array(playerCount).fill("CREW");

      const impostorIndexes = new Set();
      while(impostorIndexes.size < impostors){
        impostorIndexes.add(Math.floor(Math.random() * playerCount));
      }
      for(const idx of impostorIndexes){
        roles[idx] = "IMPOSTOR";
      }

      return { character, roles, impostors };
    }

    function resetUIToReady(){
      whoText.textContent = "Partida lista. Presiona Revelar para el Jugador 1.";
      roleText.textContent = "‚Äî";
      hintText.textContent = "El impostor no ver√° el personaje.";
      hideImage();

      revealBtn.disabled = false;
      nextBtn.disabled = true;
      nextBtn.textContent = "Ocultar / Siguiente";
      nextBtn.className = "nextBtn"; // azul por defecto (aunque est√© deshabilitado)
    }

    function endGameUI(){
      whoText.textContent = "Todos los jugadores ya vieron su rol.";
      roleText.textContent = "Listo ‚úÖ";
      hintText.textContent = "Ahora pueden empezar a jugar.";
      hideImage();

      revealBtn.disabled = true;
      nextBtn.disabled = true;
      nextBtn.textContent = "Ocultar / Siguiente";
      nextBtn.className = "nextBtn";

      setPhase("Finalizado");
    }

    function startGame(){
      const n = Number(playersInput.value || 0);

      if(!Number.isFinite(n) || n < 3){
        alert("Pon al menos 3 jugadores.");
        return;
      }
      if(n > 30){
        alert("M√°ximo 30 jugadores (puedes subirlo si quieres).");
        return;
      }

      const { character, roles, impostors } = buildRoles(n);
      game = {
        totalPlayers: n,
        currentPlayer: 1,
        character,
        roles,
        impostors,
        revealed: false
      };

      impostorCount.textContent = String(impostors);

      setPhase("En curso");
      setProgress(0, n);

      resetBtn.disabled = false;
      startBtn.disabled = true;
      playersInput.disabled = true;

      resetUIToReady();
    }

    function resetGame(){
      game = null;

      setPhase("Configuraci√≥n");
      setProgress(0, 0);

      impostorCount.textContent = "‚Äî";

      whoText.textContent = "A√∫n no inicia la partida.";
      roleText.textContent = "‚Äî";
      hintText.textContent = "Inicia la partida para asignar roles.";
      hideImage();

      revealBtn.disabled = true;
      nextBtn.disabled = true;
      nextBtn.textContent = "Ocultar / Siguiente";
      nextBtn.className = "nextBtn";

      resetBtn.disabled = true;
      startBtn.disabled = false;
      playersInput.disabled = false;
    }

    function revealRole(){
      if(!game) return;

      const idx = game.currentPlayer - 1;
      const role = game.roles[idx];

      game.revealed = true;

      whoText.textContent = `Jugador ${game.currentPlayer} de ${game.totalPlayers}`;
      if(role === "IMPOSTOR"){
        roleText.textContent = "IMPOSTOR üòà";
        hintText.textContent = "Finge. No reveles que eres impostor.";
        showImage(IMPOSTOR_IMAGE, "Imagen del impostor");
      } else {
        roleText.textContent = game.character;
        hintText.textContent = "Memoriza el personaje y luego oculta.";
        showImage(getCharacterImagePath(game.character), "Imagen de " + game.character);
      }

      revealBtn.disabled = true;

      // El bot√≥n √∫nico pasa a comportarse como "Ocultar"
      nextBtn.disabled = false;
      nextBtn.textContent = "Ocultar";
      nextBtn.className = "revealBtn"; // rojo (misma clase que ocultar antes)
    }

    function hideAndPrepareNext(){
      if(!game) return;

      // Si est√° revelado -> Ocultar (equivalente a hideRole)
      if(game.revealed){
        game.revealed = false;

        roleText.textContent = "‚Äî";
        hintText.textContent = "Pasa el tel√©fono al siguiente jugador.";
        whoText.textContent = `Jugador ${game.currentPlayer} listo.`;

        hideImage();

        // Ahora el bot√≥n √∫nico se comporta como "Siguiente jugador"
        nextBtn.textContent = "Siguiente jugador";
        nextBtn.className = "nextBtn"; // azul
        // reveal sigue deshabilitado hasta que presione "Siguiente"
        revealBtn.disabled = true;
        return;
      }

      // Si NO est√° revelado -> Siguiente jugador (equivalente a nextPlayer)
      setProgress(game.currentPlayer, game.totalPlayers);

      if(game.currentPlayer >= game.totalPlayers){
        endGameUI();
        return;
      }

      game.currentPlayer += 1;

      whoText.textContent = `Listo para Jugador ${game.currentPlayer}. Presiona Revelar.`;
      roleText.textContent = "‚Äî";
      hintText.textContent = "El impostor no ver√° el personaje.";
      hideImage();

      revealBtn.disabled = false;

      // Volvemos a estado inicial del bot√≥n √∫nico
      nextBtn.disabled = true;
      nextBtn.textContent = "Ocultar / Siguiente";
      nextBtn.className = "nextBtn";
    }

    // ==========
    // EVENTOS
    // ==========
    startBtn.addEventListener("click", startGame);
    resetBtn.addEventListener("click", resetGame);

    revealBtn.addEventListener("click", revealRole);
    nextBtn.addEventListener("click", hideAndPrepareNext);

    // Estado inicial
    resetGame();
  </script>
</body>
</html>


